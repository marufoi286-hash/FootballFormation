承知しました。
これまでの議論（スマホ操作、横画面閲覧、PDF出力、マスタ管理）をすべて反映した\*\*「画面設計書」\*\*を作成しました。

特に**S05: フォーメーション編集画面**と**S06: 閲覧画面**における、画面の向き（縦・横）によるUIの切り替え挙動を明確に定義しています。

これをコピーして `docs/02_screen_design.md` として保存してください。

-----

### ファイル名: `docs/02_screen_design.md`

````markdown
# 画面設計書 (Screen Design Document)

## 1. 画面遷移図 (Screen Flow)

```mermaid
graph TD
    %% 外部・認証
    Login[S01: ログイン画面] -->|認証成功| Home[S02: 試合一覧画面]
    SharedURL((S06: 共有URL)) -->|アクセス| PublicView[S06: 閲覧専用画面]

    %% メインフロー
    Home -->|新規作成/選択| MatchDetail[S04: 試合詳細・構成画面]
    Home -->|メニュー| Master[S03: マスタ管理画面]

    %% マスタ管理
    Master -->|タブ切替| MasterPlayers[選手マスタ]
    Master -->|タブ切替| MasterVenues[会場マスタ]

    %% 編集フロー
    MatchDetail -->|フォーメーション追加/編集| EditFormation[S05: 配置編集画面]
    MatchDetail -->|PDFダウンロード| PDF((PDF出力))

    %% 編集詳細
    EditFormation -->|選手タップ| PlayerModal[選手編集モーダル]
    EditFormation -->|保存| MatchDetail
````

## 2\. 共通UI・レイアウト要件

  * **ヘッダー (Header)**:
      * ログイン時: ロゴ、チーム名、「ログアウト」ボタンを表示。
      * 閲覧時: ロゴのみシンプルに表示。
  * **トースト通知 (Toast)**:
      * 保存成功時: 「保存しました」を画面上部に緑色で表示。
      * エラー時: 「エラーが発生しました」を赤色で表示。
  * **ローディング (Loading)**:
      * API通信中は画面中央にスピナーを表示し、操作をブロックする。

-----

## 3\. 画面詳細定義

### S01: ログイン画面

  * **URL**: `/login`
  * **概要**: チームIDと共通パスワードで認証を行う。
  * **UI要素**:
      * テキストボックス: チームID
      * パスワードボックス: パスワード
      * ボタン: 「ログイン」
  * **挙動**:
      * ログイン成功後、JWTをローカルストレージに保存し、S02へ遷移。
      * ログイン状態であれば自動的にS02へリダイレクト。

### S02: 試合一覧画面 (ホーム)

  * **URL**: `/matches`
  * **概要**: 作成済みの試合フォルダを一覧表示する。
  * **UI要素**:
      * **ヘッダー**: マスタ管理へのリンクアイコン。
      * **リスト**: 試合カード（日付、対戦相手、会場）を降順表示。
      * **FAB (浮きボタン)**: 「＋ 新規試合」
  * **アクション**:
      * 新規作成タップ: 試合基本情報入力モーダルを表示 → 保存後 S04へ遷移。

### S03: マスタ管理画面

  * **URL**: `/master`
  * **概要**: 選手および会場の登録・編集・削除（論理削除）を行う。
  * **構成**: タブ切り替え（選手 / 会場）。
  * **UI要素 (選手タブ)**:
      * リスト: 名前、背番号、ポジション。削除ボタン（ゴミ箱アイコン）。
      * 追加エリア: 名前等の入力欄 ＋ 「追加」ボタン。
  * **UI要素 (会場タブ)**:
      * リスト: 会場名。削除ボタン。
      * 追加エリア: 会場名入力欄 ＋ 「追加」ボタン。

### S04: 試合詳細・構成画面

  * **URL**: `/matches/{matchId}`
  * **概要**: 1つの試合に含まれるフォーメーション（前半・後半など）を管理するダッシュボード。
  * **UI要素**:
      * **試合情報エリア**: 対戦相手、日付、会場（編集可能）。
      * **フォーメーションリスト**:
          * 各カードに「ラベル（前半など）」「プレビュー画像（縮小版ピッチ）」「メモ要約」を表示。
          * タップで S05 へ遷移。
      * **アクションボタン群**:
          * 「＋ フォーメーション追加」
          * 「PDFダウンロード」（Puppeteer APIをコール）
          * 「一括保存」（手動保存トリガー）

### S05: 配置編集画面 (Core Feature)

  * **URL**: `/matches/{matchId}/formations/{formationId}`
  * **推奨向き**: **縦画面 (Portrait)**
  * **概要**: ピッチへの選手配置、メモの記述を行う。
  * **レイアウト (上から順)**:
    1.  **ヘッダー**: 「戻る」「保存」ボタン。
    2.  **ピッチエリア (Canvas/Div)**:
          * 正方形に近い比率で表示。
          * 選手アイコン（丸形＋名前＋背番号）。
    3.  **情報入力エリア**:
          * ラベル入力（例: 前半）。
          * メモ入力（Textarea: 交代策など）。
    4.  **メンバーリスト (BottomSheet/Scroll)**:
          * ベンチ入り選手、未登録選手（ゲスト作成ボタン）を表示。
  * **操作 (Drag & Drop)**:
      * **リスト → ピッチ**: 新規配置。
      * **ピッチ内移動**: 位置調整。
      * **ピッチ外へドラッグ**: ベンチに戻す。
  * **操作 (Tap)**:
      * ピッチ上の選手をタップ → **編集モーダル**起動。
          * 名前変更（ゲスト用）、背番号変更、削除が可能。

### S06: 閲覧専用画面 (ゲスト用)

  * **URL**: `/share/{uuid}` (Login不要)
  * **推奨向き**: **横画面 (Landscape)**
  * **概要**: 共有されたURLを知っている人が戦術を確認する画面。
  * **UI要素**:
      * **ビューワー**: ピッチを画面いっぱいに表示。
      * **タブ/スワイプ**: 前半・後半などのフォーメーションを切り替え。
      * **下部情報バー**: 交代メモなどをオーバーレイまたは下部に表示。
  * **UX工夫**:
      * スマホで縦画面で開いた場合、「横画面にすると見やすいです」というトーストまたはアイコンを表示する。

-----

## 4\. UI/UX 技術的詳細 (Vue.js)

### 4.1 ドラッグ操作の最適化

  * **Touch Offset**: スマホでドラッグ中、指でアイコンが隠れないよう、タッチ位置の少し上（Y軸 -50px等）にアイコンを描画する。
  * **Snap (吸着)**: マグネット機能は実装せず、自由配置とする（要件定義より）。ただし、ピッチ枠外へのドロップは無効とする。

### 4.2 画面の向き (Orientation) 制御

  * ブラウザの仕様上、JSで強制的に回転させることはできないため、CSSとガイダンスで制御する。
  * **編集画面 (S05)**:
      * 横向きにされた場合、ヘッダー等の高さを極力減らし、編集エリア（ピッチ＋リスト）が隠れないようにレスポンシブ対応する。
      * 基本的には縦持ち操作を促すUI設計とする。
  * **閲覧画面 (S06)**:
      * 縦向きの場合、「スマホを横にしてください [回転アイコン]」というオーバーレイを一瞬出すなどして誘導する。

### 4.3 ゲスト（名無し）入力のUI

  * S05で「ゲスト追加」ボタンを押すと、ピッチ中央またはベンチに「FW」「MF」などの初期値を持つアイコンが生成される。
  * 配置後、アイコンをタップして「鈴木(助っ人)」のようにリネームするフローとする。

<!-- end list -->

```

***

### プロジェクト定義の完了

これですべての設計ドキュメントが揃いました。

1.  **要件定義書 (`01_requirements.md`)**: 何を作るか。
2.  **画面設計書 (`02_screen_design.md`)**: どんな見た目か。
3.  **DB設計書 (`03_database_schema.md`)**: データはどう持つか。
4.  **API仕様書 (`04_api_spec.md`)**: どう通信するか。
    * ※インフラ(`05`)は要件定義書内の非機能要件でカバー済みとみなせます。

### 次のアクション：開発スタート

いよいよコードを書き始めるフェーズです。
以下のどちらから着手するのがご希望ですか？

1.  **【バックエンド (.NET) のセットアップ】**:
    * プロジェクト作成、Entity FrameworkでのDB接続、まずは「ログインAPI」を作って動かすところまで。
2.  **【フロントエンド (Vue.js) のモック作成】**:
    * Viteでプロジェクト作成、Tailwind CSS等を入れて、まずは「ドラッグ＆ドロップでアイコンが動く画面」を作ってみる（一番楽しいところ）。
```